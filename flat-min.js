var FlatJS=FlatJS||{};(function(){var t=[],e=[],i=false;fnTest=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;FlatJS.Classy=function(){this._=function(e,i){if(typeof e==="function"){var n=this,s=t[n]=t[n]||[];this.icnt=this.icnt||s.length+1;s=s[this.icnt]=s[this.icnt]||[];var a=s[e]=s[e]||function(){s[e][n.icnt]=this;return e.apply(n,arguments)}}else{var a=this._(r)(e,i)}return a}};FlatJS.Classy.extend=function(t){if(typeof t==="function"){t=t()}var e=this.prototype;i=true;var r=new this;i=false;for(var n in t){r[n]=typeof t[n]=="function"&&typeof e[n]=="function"&&fnTest.test(t[n])?function(t,i){return function(){var r=this._super;this._super=e[t];var n=i.apply(this,arguments);this._super=r;return n}}(n,t[n]):t[n]}function s(){if(!i&&this.init){this.init.apply(this,arguments)}s.fjsObjects.push(this)}for(var n in this){if(!s[n]){s[n]=this[n]}}s.prototype=r;s.prototype.constructor=s;s.extend=arguments.callee;s.fjsObjects=[];return s};function r(t,i){var r=e[this]=e[this]||[];r=r[t]=r[t]||[];this.varcnt=this.varcnt||r.length+1;r[this.varcnt]=typeof i!=="undefined"?i:r[this.varcnt]||null;return r[this.varcnt]}})();var FlatJS=FlatJS||{};FlatJS.Runner=function(){function t(t){t=t||{};var e=t.context||window,i=t.node||document,r=t.init!==undefined?t.init:true,n=t.attr||"fjs-component",s=t.objKey||"fjsComponents",a=t.findFn||function(t){t()},f=t.callFn||false;var o=FlatJS.Helpers.getAllElementsWithAttribute;this.init=function(t){t=t||i;var e=o(n,t),r=e.length;for(var s=0;s<r;s++){this.moduleInit(e[s])}};function u(t,e,i){var r=FlatJS.Helpers.findFunctionByString(e,i);return l(r,t,e)}function l(t,e,i){if(!e[s]){e[s]={}}if(typeof f==="function"){var r=f(t,e)}else{var r=new t(e)}e[s][i]=r;return r}this.moduleInit=function(t){var i=t.getAttribute(n);if(typeof i!=="string"){return}i=i.split(" ");var r=i.length;for(var s=0;s<r;s++){(function(){var r=i[s];var n=FlatJS.Helpers.convertDashedToCamelCase(r);a(function(){u(t,n,e)},t,r)})()}};if(r){this.init()}}return t}();var FlatJS=FlatJS||{};FlatJS.Helpers=function(){var t=FlatJS.Classy.extend({convertDashedToCamelCase:function(t){if(t){t=t.replace(/-([a-z])/g,function(t){return t[1].toUpperCase()}).replace(/\s+/g,"")}return t},isArray:function(t){return Object.prototype.toString.call(t)==="[object Array]"},getAllElementsWithAttribute:function(t,e){e=e||node;var i=[],r=e.getElementsByTagName("*"),n=r.length;for(var s=0;s<n;s++){if(r[s].getAttribute(t)!==null){i.push(r[s])}}if(e!==document&&e.getAttribute&&e.getAttribute(t)!==null){i.push(e)}return i},findFunctionByString:function(t,e,i){e=e||window;if(t.indexOf&&t.indexOf(".")!==-1){t=t.split(".")}if(typeof t==="string"&&typeof e[t]==="function"){return e[t]}else if(typeof t!=="object"){return false}var r=e[t[0]]||{},n=r[t[1]];if(typeof r==="object"&&typeof n==="function"){return n}else if(typeof n==="object"&&t[2]){t.splice(0,1);return this.findFunctionByString(t,r,i)}else if(i&&t[1]){var r=e[t[0]]=e[t[0]]||{};t.splice(0,1);return this.findFunctionByString(t,r,i)}else if(i){e[t[0]]=i;return e[t[0]]}}});return new t}();var FlatJS=FlatJS||{};FlatJS.Widget=function(){var t=FlatJS.Classy.extend({init:function(t){this.obj=t;if(this.renderOnInit!==false&&typeof this.render==="function"){this.render()}},render:function(){this.initializer();this.renderUI();this.bindUI();this.syncUI()},initializer:function(){},renderUI:function(){},bindUI:function(){},syncUI:function(){}});return t}();FlatJS.Dispatch=function(){var t={},e={};t.publish=function(t,i){if(e[t]){for(var r=0;r<e[t].length;r++){if(e[t][r]){e[t][r].fn.apply(this,i)}}}};t.subscribe=function(t,i){if(!e[t]){e[t]=[]}e[t].push({instance:this,fn:i})};t.unsubscribe=function(i,r){if(e[i]){if(r){for(var n=0;n<e[i].length;n++){var s=e[i][n];if(s&&s.fn&&s.fn===r){e[i].splice(s,1)}}}else{if(this!==t){for(var n=0;n<e[i].length;n++){var s=e[i][n];if(s&&s.instance&&s.instance===this){e[i].splice(s,1)}}}else{e[i]=[]}}}else if(!i&&!r&&this!==t){for(var a in e){var i=e[a];for(var f in i){var s=i[f];if(typeof s.fn==="function"&&s.instance===this){i.splice(s,1)}}}}};if(FlatJS.Classy){FlatJS.Classy.prototype.publish=function(e,i){this._(t.publish)(e,i)};FlatJS.Classy.prototype.subscribe=function(e,i){this._(t.subscribe)(e,i)};FlatJS.Classy.prototype.unsubscribe=function(e,i){this._(t.unsubscribe)(e,i)}}if(FlatJS.Widget){FlatJS.Widget.prototype.destroy=function(){this.unsubscribe()}}return t}();FlatJS.Resource=function(){var t=FlatJS.Classy.extend({init:function(t){this._("fjsNodes",[]);this._("fjsCbs",{});if(!this.id||t&&!t.id){this.id=this._(e)()}this.extend(t)},get:function(t,e){t=t.split(".");var i=this;for(var r=0;r<t.length;r++){if(e!==undefined&&r===t.length-1){i[t[r]]=e}i=i[t[r]]}return i},set:function(t,e){var r=this.get(t);this.get(t,e);if(this._("fjsCbs")){var n=this._("fjsCbs")[t];for(var s in n){var a=n[s];i(a,t,r,e,this)}if(this._("fjsCbs")["all"]){var a=this._("fjsCbs")["all"];i(a,t,r,e,this)}}},watch:function(t,e){var i=this._("fjsCbs");i[t]=i[t]||{};i[t][e]=i[t][e]||[];i[t][e].push(e);this._("fjsCbs",i)},unwatch:function(t,e){var i=this._("fjsCbs");if(i&&i[t]){if(e&&i[t][e]){delete i[t][e]}else if(!e){delete i[t]}}else{this._("fjsCbs",{})}},extend:function(e){return t.objExtend(this,e)},push:function(t,e){var i=this.get(t);if(i&&typeof i.push==="function"&&typeof i.slice==="function"){var r=i.slice();r.push(e);this.set(t,r)}},"delete":function(){for(n in this._("fjsNodes")){var t=this._("fjsNodes")[n];if(t&&t.parentNode){t.parentNode.removeChild(t)}}var e=this.constructor.fjsObjects.indexOf(this);this.constructor.fjsObjects.splice(e,1);this.set("fjsDelete",true)}});function e(){var t=Math.floor(Math.random()*9999+1)*-1;if(this.constructor.find(t)){return this._(e)()}else{return t}}function i(t,e,i,r,n){for(var s=0;s<t.length;s++){var a=t[s];if(typeof a=="function"){a(e,i,r,n)}}}t.objExtend=function(){var t={};var e=function(e){return e==null?String(e):t[toString.call(e)]||"object"};var i=function(t){return t!=null&&t==t.window};var r=function(t){return toString.call(t)==="[object Function]"};var n=Array.isArray||function(t){return e(t)==="array"};var s=function(t){if(!t||e(t)!=="object"||t.nodeType||i(t)){return false}try{if(t.constructor&&!hasOwn.call(t,"constructor")&&!hasOwn.call(t.constructor.prototype,"isPrototypeOf")){return false}}catch(r){return false}var n;for(n in t){}return n===undefined||hasOwn.call(t,n)};var a=function(){var t,e,i,f,o,u,l=arguments[0]||{},c=1,h=arguments.length,d=false;if(typeof l==="boolean"){d=l;l=arguments[1]||{};c=2}if(typeof l!=="object"&&!r(l)){l={}}if(h===c){l=this;--c}for(;c<h;c++){if((t=arguments[c])!=null){for(e in t){i=l[e];f=t[e];if(l===f){continue}if(d&&f&&(s(f)||(o=n(f)))){if(o){o=false;u=i&&n(i)?i:[]}else{u=i&&s(i)?i:{}}l[e]=a(d,u,f)}else if(f!==undefined){l[e]=f}}}}return l};return a}();t.find=function(t){var e;for(var i=0;i<this.fjsObjects.length&&!e;i++){var r=this.fjsObjects[i];if(r.id==t){e=r}}return e};return t}();var FlatJS=FlatJS||{};FlatJS.Component=FlatJS.Widget.extend(function(){var t={resource:"fjs-resource",json:"fjs-json",id:"fjs-id","class":"fjs-class",key:"fjs-key",array:"fjs-array",object:"fjs-obj"},e=FlatJS.Helpers.convertDashedToCamelCase;var i={fjsData:undefined,render:function(){this._(n)();this._(u)();this._(J)();this._(s)();this._(A)();this._(j)();this.initializer();this.renderUI();this.syncUI();this.bindUI()},findResourceFromNode:function(e){if(e.hasAttribute&&e.hasAttribute(t.resource)&&e.hasAttribute(t.id)){var i=r(e.getAttribute(t.resource));return i.find(e.getAttribute(t.id))}else if(e===document){return false}else{return this.findResourceFromNode(e.parentNode)}}};function r(t){return FlatJS.Helpers.findFunctionByString(e(t))}function n(){this.fjsData=this.fjsData||new FlatJS.Resource}function s(){var e=FlatJS.Helpers.getAllElementsWithAttribute(t.class,this.obj);for(var i=0;i<e.length;i++){var r=e[i],n=this.findResourceFromNode(r);if(n){this._(a)(r,n)}}}function a(e,i){var r=JSON.parse(e.getAttribute(t.class)),r=r[0].push?r:[r];for(var n=0;n<r.length;n++){var s=r[n],a=s[0],f=s[1],o=s[2],u=s[3],l=i[a]==f;if(l){if(e.className.indexOf(o)===-1){e.className=e.className+" "+o+" "}e.className=e.className.replace(u,"")}else if(!l){e.className=e.className.replace(o,"");e.className=e.className.replace(u,"");if(u&&e.className.indexOf(u)===-1){e.className=e.className+" "+u+" "}}}}function f(t){var e=t.getAttribute("type");if(t.innerHTML&&!t.value){return t.innerHTML}else if(e=="checkbox"||e=="radio"){return t.checked?t.value!=="on"?t.value:true:t.checked}else if(t.value){return t.value}}function o(t,e){var i=t.getAttribute("type"),e=e!==undefined?e:"";if(i=="checkbox"){if(typeof e==="boolean"){t.checked=e}else if(typeof e==="string"){t.checked=true;t.value=e?e:t.value}else if(typeof e==="object"){t.checked=e.selected;t.value=e.value}}else if(i=="radio"){if(typeof e==="boolean"){t.checked=e}else if(t.value==e){t.checked=true}else{t.checked=false}}else if(i=="text"||typeof t.value!=="undefined"){t.value=e}else if(typeof t.innerHTML!=="undefined"){t.innerHTML=e}}function u(e){e=e||this.obj;var i=FlatJS.Helpers.getAllElementsWithAttribute(t.resource,e);for(var r=0;r<i.length;r++){var n=i[r];this._(l)(n)}}function l(i){var r=i.getAttribute(t.id),n=e(i.getAttribute(t.resource)),s=FlatJS.Helpers.findFunctionByString(n,window,FlatJS.Resource.extend({})),a=s.find(r)||new s({id:r});a.modelName=a.modelName||n;if(a._("fjsNodes").indexOf(i)===-1){a._("fjsNodes").push(i)}if(i.hasAttribute(t.json)){a.extend(JSON.parse(i.getAttribute(t.json)))}this._(c)(a,i);return a}function c(e,i){var r=i.childNodes;for(var n=0;n<r.length;n++){var s=r[n];if(s&&s.hasAttribute){if(s.hasAttribute(t.key)){this._(d)(e,s)}else if(s.hasAttribute(t.array)){this._(h)(e,s)}}if(s.childNodes&&s.childNodes.length>0){if(s.hasAttribute&&!s.hasAttribute(t.resource)){this._(c)(e,s)}}}}function h(i,r){var n=r.childNodes,s=e(r.getAttribute(t.array)),a=i[s]=i[s]||[];for(var f=0;f<n.length;f++){var o=n[f];if(o.hasAttribute&&o.hasAttribute(t.resource)){var u=this._(l)(o);if(a.indexOf(u)==-1){a.push(u)}}}}function d(i,r){var n=e(r.getAttribute(t.key)),s=this._(f)(r);i[n]=s}function v(i,r,n,s){for(var a=0;a<s._("fjsNodes").length;a++){var f=s._("fjsNodes")[a],u=i.split("."),u=u[u.length-1];if(f&&f.getAttribute(t.key)&&e(f.getAttribute(t.key))===u){this._(o)(f,n)}else if(f&&s.get(i)&&s.get(i).length&&s.get(i).push&&f.hasAttribute(t.array)&&e(f.getAttribute(t.array))===u){this._(b)(f,n,r,s)}else if(f&&f.hasAttribute(t.object)&&e(f.getAttribute(t.object))===u){this._(y)(f,s)}}}function b(t,e,i,r){this._(p)(e,t);this._(A)(t);this._(u)(t);this._(s)()}function p(e,i){var r=i.childNodes,n=i.fjsTemplate,s=[];for(var a=0;a<r.length&&!n;a++){var f=r[a];if(f.hasAttribute){n=i.fjsTemplate=f.cloneNode(true)}}i.innerHTML="";for(var o=0;o<e.length;o++){var u=e[o];if(u){if(!u.id||u.id&&u.constructor.find(u.id)){var l=n.cloneNode(true),c=this._(g)(l,u,true);if(u.id){c.setAttribute(t.id,u.id)}i.appendChild(c)}}}}function g(t,e,i){var r=t.childNodes;for(var n=0;n<r.length;n++){var s=r[n];if(s.hasAttribute){this._(y)(s,e)}}if(i){return t}}function y(e,i){var r;if(e.hasAttribute(t.key)){r=FlatJS.Helpers.convertDashedToCamelCase(e.getAttribute(t.key));this._(o)(e,i[r]);if(i[r]==true&&(e.getAttribute("type")==="radio"||e.getAttribute("type")==="checkbox")){i[r]=this._(f)(e)}}else if(e.hasAttribute(t.object)){r=FlatJS.Helpers.convertDashedToCamelCase(e.getAttribute(t.object));if(i[r]){this._(g)(e,i[r])}}else if(e.getAttribute(t.resource)){r=FlatJS.Helpers.convertDashedToCamelCase(e.getAttribute(t.resource));if(i[r].id){e.setAttribute(t.id,i[r].id)}this._(g)(e,i[r])}else if(e.hasAttribute(t.array)){var r=FlatJS.Helpers.convertDashedToCamelCase(e.getAttribute(t.array)),n=i[r];if(n&&e.childNodes){this._(p)(n,e)}}else if(e.childNodes&&e.childNodes.length>0){this._(g)(e,i)}}function j(){var i=FlatJS.Helpers.getAllElementsWithAttribute(t.key,this.obj);for(var r=0;r<i.length;r++){var n=i[r];if(n&&n.fjsObject){key=e(n.getAttribute(t.key)),attr=n.fjsObject[key];if(attr){this._(o)(n,attr)}}}}function A(e){e=e||this.obj;this._(_)(t.key,e);this._(_)(t.array,e);this._(_)(t.object,e)}function _(t,i){var r=FlatJS.Helpers.getAllElementsWithAttribute(t,i);for(var n=0;n<r.length;n++){var s=r[n];if(s&&!s.fjsWatchSet){s.fjsWatchSet=true;var a=e(s.getAttribute(t)),f=s.parentNode&&s.parentNode!==document?this._(S)(a,s.parentNode):a,o=this.findResourceFromNode(s)||this.fjsData;if(o._("fjsNodes").indexOf(s)===-1){o._("fjsNodes").push(s)}s.fjsObject=s.fjsObject||o;o.watch(f,this._(v));if(this._(F)(s)){this._(N)(s)}}}}function N(t){var e=t.getAttribute("type"),e=!e||e==="text",i=typeof jQuery==="function"?jQuery:false;if(i){i(t).on(e?"keyup":"change",this._(m))}else{t.addEventListener(e?"keyup":"change",this._(m))}}function m(i){var r=i.currentTarget,n=this._(f)(r),s=e(r.getAttribute(t.key)),a=r.parentNode&&r.parentNode!==document?this._(S)(s,r.parentNode):s,o=this.findResourceFromNode(r)||this.fjsData;o.set(a,n)}function F(t){var e=t.tagName,i=false,r=["INPUT","TEXTAREA"];return r.indexOf(e)!==-1}function S(i,r){if(r.hasAttribute(t.object)){i=e(r.getAttribute(t.object))+"."+i}if(r.parentNode&&r.parentNode!==this.obj&&r.parentNode!==document){return this._(S)(i,r.parentNode)}else{return i}}function J(i,r){r=r||this.obj.childNodes;i=i||this.fjsData;var n=FlatJS.Helpers.isArray(i);for(var s=0;s<r.length;s++){var a=r[s];if(a.hasAttribute){var o=a.hasAttribute(t.resource);if(a.hasAttribute(t.key)){var u=e(a.getAttribute(t.key));if(a.getAttribute("type")==="radio"){i[u]=i[u]||this._(f)(a)}else{i[u]=this._(f)(a)}}else if(o||a.hasAttribute(t.object)){this._(k)(a,i,o,n)}else if(a.hasAttribute(t.array)){this._(C)(a,i,n)}else{this._(x)(a,i)}}}}function C(i,r,n){var s=i.childNodes,a=false,f=e(i.getAttribute(t.array));r=r[f]=[];for(var o=0;o<s.length&&!a;o++){var u=s[o];if(u&&u.hasAttribute){i.fjsTemplate=i.fjsTemplate||u.cloneNode(true);if(u.hasAttribute(t.resource)){a=true;this._(J)(r,s)}else{var l={};r.push(l);this._(J)(l,u.childNodes)}}}}function k(i,n,s,a){var f=i.hasAttribute(t.object),o=e(i.getAttribute(f?t.object:t.array));if(s){var u=r(i.getAttribute(t.resource)),l=u?u.find(i.getAttribute(t.id)):false;if(l){if(a){n.push(l)}else{n[o]=l}l.watch("fjsDelete",this._(O))}}else{this._(x)(i,n,o,f)}}function x(t,e,i,r){if(t.childNodes&&t.childNodes.length>0){if(i){e=e[i]=r?{}:[]}this._(J)(e,t.childNodes)}}function O(t,e,i,r){this._(T)(r,this.fjsData)}function T(t,e,i){for(var r in e){if(e[r]===t){e[r]=undefined;delete e[r]}else if(typeof e[r]==="object"){this._(T)(t,e[r],e)}}}return i});